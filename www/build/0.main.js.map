{"version":3,"sources":["../../src/pages/request-history/request-history.module.ts","../../src/pages/request-history/request-history.ts"],"names":[],"mappings":"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","file":"0.main.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { RequestHistoryPage } from './request-history';\r\nimport { OnGoingRequestsPageModule } from '../on-going-requests/on-going-requests.module';\r\nimport { RequestsPipe } from '../../pipes/requests/requests';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    RequestHistoryPage,\r\n    \r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(RequestHistoryPage),\r\n    OnGoingRequestsPageModule\r\n  ],\r\n  exports: [\r\n    RequestHistoryPage,\r\n    //RequestsPipe\r\n  ]\r\n})\r\nexport class RequestHistoryPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/request-history/request-history.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ModalController } from 'ionic-angular';\r\nimport { RequestProvider } from '../../providers/request/request';\r\nimport { AlertController } from 'ionic-angular';\r\nimport {Storage} from '@ionic/Storage';\r\nimport { RequestDetailsPage } from '../request-details/request-details';\r\nimport { NativeGeocoder, NativeGeocoderReverseResult } from '@ionic-native/native-geocoder';\r\n/**\r\n * Generated class for the RequestHistoryPage page.\r\n *\r\n * See http://ionicframework.com/docs/components/#navigation for more info\r\n * on Ionic pages and navigation.\r\n */\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-request-history',\r\n  templateUrl: 'request-history.html',\r\n})\r\nexport class RequestHistoryPage {\r\n  //storage:Storage;\r\n  clientid:string;\r\n  state = 'Inactive';\r\n  createdate:string;\r\n  requests:[{\r\n    reqtype:string,\r\n    phone:number,\r\n    reqdesc:string,\r\n    status:string,\r\n    addressString:string\r\n  }];\r\n\r\n  constructor(public navCtrl: NavController, public navParams: NavParams,private requestProvider:RequestProvider,\r\n              public alrtCtrl:AlertController,private storage:Storage,private modalCtrl:ModalController,public geocoder:NativeGeocoder) {\r\n               \r\n  }\r\n\r\n  ionViewWillEnter(){\r\n    this.storage.get('name').then(name=>{\r\n      this.requestProvider.getRequests(this.state,name).subscribe(requests=>{\r\n        this.requests=requests;\r\n        for(var request in this.requests) {\r\n          this.getLocation(this.requests[request])\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad AllRequestPage');\r\n    \r\n  }\r\n\r\n  showRequestDetails(request){\r\n\r\n    let modal = this.modalCtrl.create(RequestDetailsPage,{'request':request});\r\n    modal.present();\r\n\r\n    /*let alert = this.alrtCtrl.create({\r\n      title:'<div class =\"request-title\">' + \"Request Details\" + '</div>',\r\n      subTitle: '<b>' + 'Type: ' + '</b>' + request.reqtype  + '<br><br>' +\r\n                '<b>' + 'Description: ' +'</b>' + request.reqdesc + '<br><br>' + \r\n                '<b>' + 'Create Date: ' + '</b>' + request.createdate + '<br><br>' +\r\n                '<b>' + 'Status: ' + '</b>' + request.status + '<br><br>'+\r\n                '<b>' + 'Service Date: ' + '</b>' + request.date  ,\r\n      buttons:[\r\n        {\r\n          text:'Cancel Job',\r\n          handler:()=>{\r\n            let alert2 = this.alrtCtrl.create({\r\n              title: 'Delete Request!!',\r\n              subTitle: 'Are you sure you want to Cancel this Service ?',\r\n              buttons:[\r\n                {\r\n                  text: 'No',\r\n                  role: 'cancel'\r\n                },\r\n                {\r\n                  text: 'Yes',\r\n                  handler:()=>{\r\n                    this.requestProvider.updateRequest(request._id).subscribe(success=>{\r\n                      var index = this.requests.indexOf(request,0);\r\n                      if(index > -1){\r\n                        this.requests.splice(index,-1);\r\n                        this.navCtrl.setRoot(this.navCtrl.getActive().component);\r\n                      }\r\n                    });\r\n                  }\r\n                }\r\n              ]\r\n            });\r\n            alert2.present();\r\n          }\r\n        },\r\n        {\r\n          text:'OK',\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n    alert.present();*/\r\n    \r\n  }\r\n\r\n  menuOpened(){\r\n\r\n  }\r\n\r\n  menuClosed(){\r\n\r\n  }\r\n\r\n  refresh(){\r\n    this.navCtrl.setRoot(this.navCtrl.getActive().component);\r\n  }\r\n /*editRequest(request){\r\n   this.navCtrl.push(ActiveRequestsPage,{\r\n     request:request\r\n   });\r\n }*/\r\n\r\n logout(){\r\n    this.storage.clear().then(() => {\r\n      console.log('Keys have been cleared');\r\n    });\r\n    this.navCtrl.parent.parent.setRoot('LoginPage');\r\n    \r\n  }\r\n  \r\n  getLocation(request){\r\n    \r\n    this.geocoder.reverseGeocode(request.address.geometry.coordinates.lat,request.address.geometry.coordinates.lng).then((res: NativeGeocoderReverseResult) => {\r\n      let msg ='';\r\n      let arr = [ 'houseNumber', 'street', 'city', 'district', 'postalCode', 'countryName' ];\r\n      for (var v in arr){ \r\n        if(res[arr[v]]){\r\n           msg += res[arr[v]]+', ';\r\n        }\r\n      }\r\n      msg = msg.slice(0, -2);\r\n      if(msg.length > 25)\r\n        msg = msg.substring(0, 25)+'...';\r\n      //alert(msg)\r\n      request.addressString= msg;\r\n    });\r\n\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/request-history/request-history.ts"],"sourceRoot":""}